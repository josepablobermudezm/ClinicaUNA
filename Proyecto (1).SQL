/*
Created: 03/09/2019
Modified: 04/09/2019
Model: RE Oracle 11g Release 2
Database: Oracle 11g Release 2
*/


-- Drop relationships section -------------------------------------------------

ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE DROP CONSTRAINT CTL_RELACION_EXAM
;
ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE DROP CONSTRAINT PAC_RELACION_CTL
;
ALTER TABLE CLINICAUNA.CLN_AGENDA DROP CONSTRAINT MED_RELACION_AGEN
;
ALTER TABLE CLINICAUNA.CLN_ESPACIO_HORA DROP CONSTRAINT AGEN_RELACION_PAC
;
ALTER TABLE CLINICAUNA.CLN_CITAS DROP CONSTRAINT ESP_RELACION_CITA
;
ALTER TABLE CLINICAUNA.CLN_CITAS DROP CONSTRAINT PAC_RELACION_CITA
;
ALTER TABLE CLINICAUNA.CLN_EXPEDIENTE DROP CONSTRAINT PAC_RELACION_EXP
;
ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS DROP CONSTRAINT US_RELACION_MED
;
ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES DROP CONSTRAINT PAC_RELACION_MED
;
ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES DROP CONSTRAINT MED_RELACION_PAC
;




-- Drop keys for tables section -------------------------------------------------

ALTER TABLE CLINICAUNA.CLN_EXAMEN DROP CONSTRAINT PK_CLN_EXAMEN
;
ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE DROP CONSTRAINT PK_CLN_CONTROL_PACIENTE
;
ALTER TABLE CLINICAUNA.CLN_EXPEDIENTE DROP CONSTRAINT PK_CLN_EXPEDIENTE
;
ALTER TABLE CLINICAUNA.CLN_ESPACIO_HORA DROP CONSTRAINT PK_CLN_ESPACIO_HORA
;
ALTER TABLE CLINICAUNA.CLN_CITAS DROP CONSTRAINT PK_CLN_CITAS
;
ALTER TABLE CLINICAUNA.CLN_AGENDA DROP CONSTRAINT PK_CLN_AGENDA
;
ALTER TABLE CLINICAUNA.CLN_TB_USUARIOS DROP CONSTRAINT PK_CLN_TB_USUARIOS
;
ALTER TABLE CLINICAUNA.CLN_TB_USUARIOS DROP CONSTRAINT US_NOMBRE_USUARIO
;
ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES DROP CONSTRAINT PK_CLN_TB_MEDICOS_PACIENTES
;
ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS DROP CONSTRAINT PK_CLN_TB_MEDICOS
;
ALTER TABLE CLINICAUNA.CLN_PACIENTES DROP CONSTRAINT PK_CLN_PACIENTES
;




-- Drop tables section ---------------------------------------------------

DROP TABLE CLINICAUNA.CLN_EXAMEN
;
DROP TABLE CLINICAUNA.CLN_CONTROL_PACIENTE
;
DROP TABLE CLINICAUNA.CLN_EXPEDIENTE
;
DROP TABLE CLINICAUNA.CLN_ESPACIO_HORA
;
DROP TABLE CLINICAUNA.CLN_CITAS
;
DROP TABLE CLINICAUNA.CLN_AGENDA
;
DROP TABLE CLINICAUNA.CLN_TB_USUARIOS
;
DROP TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES
;
DROP TABLE CLINICAUNA.CLN_TB_MEDICOS
;
DROP TABLE CLINICAUNA.CLN_PACIENTES
;

-- Drop sequences section --------------------------------------------------- 

DROP SEQUENCE CLINICAUNA.SEQ_EXPEDIENTES
;
DROP SEQUENCE CLINICAUNA.SEQ_EXAMENES
;
DROP SEQUENCE CLINICAUNA.SEQ_CONTROL_PACIENTES
;
DROP SEQUENCE CLINICAUNA.SEQ_CITAS
;
DROP SEQUENCE CLINICAUNA.SEQ_ESPACIOS
;
DROP SEQUENCE CLINICAUNA.SEQ_AGENDAS
;
DROP SEQUENCE CLINICAUNA.SEQ_USUARIOS
;
DROP SEQUENCE CLINICAUNA.SEQ_PACIENTES
;
DROP SEQUENCE CLINICAUNA.SEQ_MEDICOS
;
-- Create sequences section -------------------------------------------------

CREATE SEQUENCE CLINICAUNA.SEQ_MEDICOS
 INCREMENT BY 1
 MAXVALUE 9999999999999
 NOMINVALUE
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_PACIENTES
 INCREMENT BY 1
 MAXVALUE 99999999999999
 NOMINVALUE
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_USUARIOS
 INCREMENT BY 1
 MAXVALUE 999999999999999
 NOMINVALUE
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_AGENDAS
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_ESPACIOS
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_CITAS
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_CONTROL_PACIENTES
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_EXAMENES
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

CREATE SEQUENCE CLINICAUNA.SEQ_EXPEDIENTES
 INCREMENT BY 1
 START WITH 1
 MAXVALUE 99999999999999999999999
 MINVALUE 1
 NOCACHE
;

-- Create tables section -------------------------------------------------

-- Table CLINICAUNA.CLN_PACIENTES

CREATE TABLE CLINICAUNA.CLN_PACIENTES(
  PAC_ID Number CONSTRAINT SYS_C007415 NOT NULL,
  PAC_NOMBRE Varchar2(50 ) CONSTRAINT SYS_C007416 NOT NULL,
  PAC_PAPELLIDO Varchar2(50 ) CONSTRAINT SYS_C007417 NOT NULL,
  PAC_SAPELLIDO Varchar2(50 ) CONSTRAINT SYS_C007418 NOT NULL,
  PAC_CEDULA Varchar2(50 ) CONSTRAINT SYS_C007419 NOT NULL,
  PAC_CORREO Varchar2(50 ) CONSTRAINT SYS_C007420 NOT NULL,
  PAC_GENERO Varchar2(1 ) CONSTRAINT SYS_C007421 NOT NULL,
  PAC_FECHANACIMIENTO Date CONSTRAINT SYS_C007422 NOT NULL,
  PAC_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_PACIENTES

ALTER TABLE CLINICAUNA.CLN_PACIENTES ADD CONSTRAINT PK_CLN_PACIENTES PRIMARY KEY (PAC_ID)
;

-- Table and Columns comments section

COMMENT ON COLUMN CLINICAUNA.CLN_PACIENTES.PAC_GENERO IS 'H es hombre y M es mujer'
;

-- Table CLINICAUNA.CLN_TB_MEDICOS

CREATE TABLE CLINICAUNA.CLN_TB_MEDICOS(
  MED_ID Number CONSTRAINT SYS_C007405 NOT NULL,
  US_ID Number CONSTRAINT SYS_C007406 NOT NULL,
  MED_CODIGO Varchar2(50 ),
  MED_FOLIO Varchar2(50 ),
  MED_CARNE Varchar2(50 ),
  MED_ESTADO Varchar2(1 ),
  MED_INICIOJORNADA Date,
  MED_FINJORNADA Date,
  MED_ESPACIOSPORHORA Number,
  MED_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_TB_MEDICOS

ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS ADD CONSTRAINT PK_CLN_TB_MEDICOS PRIMARY KEY (MED_ID)
;

-- Table and Columns comments section

COMMENT ON COLUMN CLINICAUNA.CLN_TB_MEDICOS.MED_ESTADO IS 'I es inactivo y A es activo'
;

-- Table CLINICAUNA.CLN_TB_MEDICOS_PACIENTES

CREATE TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES(
  MED_ID Number CONSTRAINT SYS_C007424 NOT NULL,
  PAC_ID Number CONSTRAINT SYS_C007425 NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_TB_MEDICOS_PACIENTES

ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES ADD CONSTRAINT PK_CLN_TB_MEDICOS_PACIENTES PRIMARY KEY (MED_ID,PAC_ID)
;

-- Table CLINICAUNA.CLN_TB_USUARIOS

CREATE TABLE CLINICAUNA.CLN_TB_USUARIOS(
  US_ID Number CONSTRAINT SYS_C007392 NOT NULL,
  US_NOMBRE Varchar2(50 ) CONSTRAINT SYS_C007393 NOT NULL,
  US_PAPELLIDO Varchar2(50 ) CONSTRAINT SYS_C007394 NOT NULL,
  US_SAPELLIDO Char(50 ) CONSTRAINT SYS_C007395 NOT NULL,
  US_CEDULA Varchar2(50 ) CONSTRAINT SYS_C007396 NOT NULL,
  US_CORREO Varchar2(50 ) CONSTRAINT SYS_C007397 NOT NULL,
  US_TIPOUSUARIO Varchar2(1 ) CONSTRAINT SYS_C007398 NOT NULL,
  US_IDIOMA Varchar2(50 ) CONSTRAINT SYS_C007399 NOT NULL,
  US_ESTADO Varchar2(1 ) CONSTRAINT SYS_C007400 NOT NULL,
  US_NOMBRE_USUARIO Varchar2(30 ) CONSTRAINT SYS_C007401 NOT NULL,
  US_CONTRASENA Varchar2(50 ),
  US_CONTRASENATEMP Varchar2(50 ) CONSTRAINT SYS_C007438 NOT NULL,
  US_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_TB_USUARIOS

ALTER TABLE CLINICAUNA.CLN_TB_USUARIOS ADD CONSTRAINT PK_CLN_TB_USUARIOS PRIMARY KEY (US_ID)
;

ALTER TABLE CLINICAUNA.CLN_TB_USUARIOS ADD CONSTRAINT US_NOMBRE_USUARIO UNIQUE (US_NOMBRE_USUARIO)
;

-- Table and Columns comments section

COMMENT ON COLUMN CLINICAUNA.CLN_TB_USUARIOS.US_TIPOUSUARIO IS 'A es administrador, R es Recepcionista y M es Médico'
;
COMMENT ON COLUMN CLINICAUNA.CLN_TB_USUARIOS.US_ESTADO IS 'A es activo y I es inactivo'
;

-- Table CLINICAUNA.CLN_AGENDA

CREATE TABLE CLINICAUNA.CLN_AGENDA(
  PK_CLN_AGENDA Number NOT NULL,
  AGE_VERSION Number NOT NULL,
  MED_ID Number
)
;

-- Add keys for table CLINICAUNA.CLN_AGENDA

ALTER TABLE CLINICAUNA.CLN_AGENDA ADD CONSTRAINT PK_CLN_AGENDA PRIMARY KEY (PK_CLN_AGENDA)
;

-- Table CLINICAUNA.CLN_CITAS

CREATE TABLE CLINICAUNA.CLN_CITAS(
  PK_CLN_CITA Number NOT NULL,
  CT_ESTADO Varchar2(2 ) NOT NULL,
  CT_MOTIVO Varchar2(100 ),
  CT_VERSION Number NOT NULL,
  PAC_ID Number,
  PK_CLN_ESPACIO_HORA Number
)
;

-- Add keys for table CLINICAUNA.CLN_CITAS

ALTER TABLE CLINICAUNA.CLN_CITAS ADD CONSTRAINT PK_CLN_CITAS PRIMARY KEY (PK_CLN_CITA)
;

-- Table and Columns comments section

COMMENT ON COLUMN CLINICAUNA.CLN_CITAS.CT_ESTADO IS 'pr = programada, at = atendida, ca = cancelada, au = ausente'
;

-- Table CLINICAUNA.CLN_ESPACIO_HORA

CREATE TABLE CLINICAUNA.CLN_ESPACIO_HORA(
  PK_CLN_ESPACIO_HORA Number NOT NULL,
  ESP_VERSION Number NOT NULL,
  PK_CLN_AGENDA Number
)
;

-- Add keys for table CLINICAUNA.CLN_ESPACIO_HORA

ALTER TABLE CLINICAUNA.CLN_ESPACIO_HORA ADD CONSTRAINT PK_CLN_ESPACIO_HORA PRIMARY KEY (PK_CLN_ESPACIO_HORA)
;

-- Table CLINICAUNA.CLN_EXPEDIENTE

CREATE TABLE CLINICAUNA.CLN_EXPEDIENTE(
  PL_CLN_EXPEDIENTE Number NOT NULL,
  EXP_ANTECEDENTE_PATOLOGICOS Varchar2(100 ) NOT NULL,
  EXP_HOSPITALIZACIONES Varchar2(1 ) NOT NULL,
  EXP_OPERACIONES Varchar2(100 ) NOT NULL,
  EXP_ALERGIAS Varchar2(100 ) NOT NULL,
  EXP_TRATAMIENTOS Varchar2(100 ) NOT NULL,
  EXP_ANTECEDENTES_FAMILIARES Varchar2(100 ) NOT NULL,
  PAC_ID Number,
  EXP_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_EXPEDIENTE

ALTER TABLE CLINICAUNA.CLN_EXPEDIENTE ADD CONSTRAINT PK_CLN_EXPEDIENTE PRIMARY KEY (PL_CLN_EXPEDIENTE)
;

-- Table and Columns comments section

COMMENT ON COLUMN CLINICAUNA.CLN_EXPEDIENTE.EXP_HOSPITALIZACIONES IS '//S = Si, N = No'
;

-- Table CLINICAUNA.CLN_CONTROL_PACIENTE

CREATE TABLE CLINICAUNA.CLN_CONTROL_PACIENTE(
  PK_CLN_CONTROL_PACIENTE Number NOT NULL,
  CNT_FECHA Date NOT NULL,
  CNT_HORA Date NOT NULL,
  CNT_PRESION Number NOT NULL,
  CNT_FRECUENCIA_CARDIACA Number NOT NULL,
  CNT_PESO Number NOT NULL,
  CNT_TALLA Number NOT NULL,
  CNT_TEMPERATURA Number NOT NULL,
  CNT_IMC Number NOT NULL,
  CNT_ANOTACION_ENFERMERIA Varchar2(150 ) NOT NULL,
  CNT_RAZON_CONSULTA Varchar2(150 ) NOT NULL,
  CNT_PLAN_ATENCION Varchar2(150 ) NOT NULL,
  CNT_OBSERVACIONES Varchar2(150 ) NOT NULL,
  CNT_EXAMEN_FISICO Varchar2(150 ) NOT NULL,
  CNT_TRATAMIENTO Varchar2(150 ) NOT NULL,
  PAC_ID Number,
  PK_CLN_EXAMEN Number,
  CNT_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_CONTROL_PACIENTE

ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE ADD CONSTRAINT PK_CLN_CONTROL_PACIENTE PRIMARY KEY (PK_CLN_CONTROL_PACIENTE)
;

-- Table CLINICAUNA.CLN_EXAMEN

CREATE TABLE CLINICAUNA.CLN_EXAMEN(
  PK_CLN_EXAMEN Number NOT NULL,
  EXM_NOMBRE_EXAMEN Varchar2(50 ) NOT NULL,
  EXM_FECHA Date NOT NULL,
  EXM_ANOTACIONES Varchar2(150 ) NOT NULL,
  EXM_VERSION Number NOT NULL
)
;

-- Add keys for table CLINICAUNA.CLN_EXAMEN

ALTER TABLE CLINICAUNA.CLN_EXAMEN ADD CONSTRAINT PK_CLN_EXAMEN PRIMARY KEY (PK_CLN_EXAMEN)
;


-- Create foreign keys (relationships) section ------------------------------------------------- 

ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES ADD CONSTRAINT MED_RELACION_PAC FOREIGN KEY (MED_ID) REFERENCES CLINICAUNA.CLN_TB_MEDICOS (MED_ID)
;



ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS_PACIENTES ADD CONSTRAINT PAC_RELACION_MED FOREIGN KEY (PAC_ID) REFERENCES CLINICAUNA.CLN_PACIENTES (PAC_ID)
;



ALTER TABLE CLINICAUNA.CLN_TB_MEDICOS ADD CONSTRAINT US_RELACION_MED FOREIGN KEY (US_ID) REFERENCES CLINICAUNA.CLN_TB_USUARIOS (US_ID)
;



ALTER TABLE CLINICAUNA.CLN_EXPEDIENTE ADD CONSTRAINT PAC_RELACION_EXP FOREIGN KEY (PAC_ID) REFERENCES CLINICAUNA.CLN_PACIENTES (PAC_ID)
;



ALTER TABLE CLINICAUNA.CLN_CITAS ADD CONSTRAINT PAC_RELACION_CITA FOREIGN KEY (PAC_ID) REFERENCES CLINICAUNA.CLN_PACIENTES (PAC_ID)
;



ALTER TABLE CLINICAUNA.CLN_CITAS ADD CONSTRAINT ESP_RELACION_CITA FOREIGN KEY (PK_CLN_ESPACIO_HORA) REFERENCES CLINICAUNA.CLN_ESPACIO_HORA (PK_CLN_ESPACIO_HORA)
;



ALTER TABLE CLINICAUNA.CLN_ESPACIO_HORA ADD CONSTRAINT AGEN_RELACION_PAC FOREIGN KEY (PK_CLN_AGENDA) REFERENCES CLINICAUNA.CLN_AGENDA (PK_CLN_AGENDA)
;



ALTER TABLE CLINICAUNA.CLN_AGENDA ADD CONSTRAINT MED_RELACION_AGEN FOREIGN KEY (MED_ID) REFERENCES CLINICAUNA.CLN_TB_MEDICOS (MED_ID)
;



ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE ADD CONSTRAINT PAC_RELACION_CTL FOREIGN KEY (PAC_ID) REFERENCES CLINICAUNA.CLN_PACIENTES (PAC_ID)
;



ALTER TABLE CLINICAUNA.CLN_CONTROL_PACIENTE ADD CONSTRAINT CTL_RELACION_EXAM FOREIGN KEY (PK_CLN_EXAMEN) REFERENCES CLINICAUNA.CLN_EXAMEN (PK_CLN_EXAMEN)
;



